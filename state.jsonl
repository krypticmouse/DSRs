{"id":"dsrs-vyr","created_at":[1767984841920,0],"created_by":"darin@darinsmacstudio.lan","title":"BAML-Bridge Integration: Typed DSPy-RS API","description":"Migrate dspy-rs from untyped HashMap<String, serde_json::Value> to typed Signature structs using baml-bridge for schema rendering and jsonish parsing. Transforms user-facing API from Example/Prediction to typed QAInput/QA structs. See CURRENT_PLAN.md and CURRENT_SPEC.md for full details.","acceptance_criteria":"1. #[derive(Signature)] generates QAInput, __QAOutput, impl Signature\n2. ChatAdapter uses BAML OutputFormatContent for schema rendering\n3. Parsing uses jsonish with per-field extraction and constraint evaluation\n4. Predict<S> returns CallResult<S> with field metadata\n5. PredictError hierarchy matches spec (Lm/Parse/Conversion variants)","priority":1,"type":"epic","labels":[],"status":"open","_at":[1767984841920,0],"_by":"darin@darinsmacstudio.lan"}
{"id":"dsrs-vyr.1","created_at":[1767984854449,1],"created_by":"darin@darinsmacstudio.lan","title":"Phase 0: Add baml-bridge dependency and re-exports","description":"Add baml-bridge path dependency to dspy-rs and set up re-exports for macro-generated code.\n\n**Files to modify:**\n- crates/dspy-rs/Cargo.toml - add baml-bridge dependency\n- crates/dspy-rs/src/lib.rs - add re-exports\n\n**Search context (use morph):**\n- Search 'baml-bridge/crates/bridge' for available public types\n- Search 'pub use' in dspy-rs/src/lib.rs for existing re-export pattern\n- Search 'BamlValue' and 'TypeIR' in baml-bridge for types to re-export\n\n**Re-exports needed:**\n```rust\npub use baml_bridge::BamlType;\npub use baml_bridge::baml_types::{BamlValue, Constraint, ConstraintLevel, ResponseCheck, TypeIR, StreamingMode, TypeValue};\npub use baml_bridge::internal_baml_jinja::types::{OutputFormatContent, RenderOptions};\npub use baml_bridge::jsonish::deserializer::deserialize_flags::Flag;\n```\n\n**Dependency path:** `baml-bridge = { path = \"../../baml-bridge/crates/bridge\", features = [\"derive\"] }`","acceptance_criteria":"1. Cargo.toml has baml-bridge dependency\n2. lib.rs re-exports BamlType, TypeIR, Constraint, OutputFormatContent, Flag\n3. cargo check passes in dspy-rs","priority":1,"type":"task","labels":[],"status":"open","_at":[1767984854449,1],"_by":"darin@darinsmacstudio.lan"}
{"id":"dsrs-vyr.2","created_at":[1767984869507,1],"created_by":"darin@darinsmacstudio.lan","title":"Phase 1: Define typed Signature trait and core types","description":"Create the new typed Signature trait, FieldSpec, ConstraintSpec, and error types that replace the legacy MetaSignature.\n\n**Files to create/modify:**\n- crates/dspy-rs/src/core/signature.rs - new typed Signature trait + FieldSpec/ConstraintSpec\n- crates/dspy-rs/src/core/errors.rs (NEW) - PredictError, ParseError, ConversionError hierarchy\n- crates/dspy-rs/src/core/call_result.rs (NEW) - CallResult<O> with FieldMeta\n- crates/dspy-rs/src/core/mod.rs - re-export new modules\n\n**Search context (use morph):**\n- Search 'MetaSignature' in dspy-rs to understand legacy trait\n- Search 'FieldMeta' or 'field metadata' in baml-bridge for inspiration\n- Search 'thiserror' in Cargo.toml to check if available\n- Search 'ResponseCheck' in baml-types for constraint result patterns\n\n**New types to define:**\n```rust\npub struct FieldSpec {\n    pub name: &'static str,       // LLM-facing name (alias or original)\n    pub rust_name: &'static str,  // Rust field ident\n    pub description: &'static str,\n    pub type_ir: fn() -> TypeIR,\n    pub constraints: &'static [ConstraintSpec],\n}\n\npub trait Signature: Send + Sync + 'static {\n    type Input: baml_bridge::BamlType;\n    type Output: baml_bridge::BamlType;\n    fn instruction() -> &'static str;\n    fn input_fields() -> &'static [FieldSpec];\n    fn output_fields() -> &'static [FieldSpec];\n    fn output_format_content() -> &'static OutputFormatContent;\n    fn from_parts(input: Self::Input, output: Self::Output) -> Self;\n    fn into_parts(self) -> (Self::Input, Self::Output);\n}\n```","acceptance_criteria":"1. FieldSpec, ConstraintSpec, ConstraintKind types defined\n2. Typed Signature trait with Input/Output associated types\n3. PredictError with Lm/Parse/Conversion variants\n4. ParseError with MissingField/ExtractionFailed/CoercionFailed/AssertFailed/Multiple variants\n5. CallResult<O> with field_flags(), field_checks(), field_raw() accessors\n6. All types exported from core/mod.rs","priority":1,"type":"task","labels":[],"status":"open","_at":[1767984869507,1],"_by":"darin@darinsmacstudio.lan"}
